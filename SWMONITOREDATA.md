# Monitor
```javascript
[ pagesVisited, requestInformations, responseInformations, swsRegs, '', swsData, swsScopes, swsClients, cacheStorage, cookiesStore, swsDuplicates, xData, pagesLinks, pagesVisitedOffline, domInfos, domInfosOffline, pagesLinksOffline, coveragePages ]
```

This is an **array**: we name the items (they refer to the names of the variables used to store the parts of the data at runtime) to aid the description that follows. The data is JSON-stringified before storage. 

## pagesVisited
Object literal associating a URL to be navigated to its final URL navigated. The special `error` value indicates an error during URL navigation (i.e. timeout, certificate issue, etc.)
```json
{
    "http://twitter.com": "https://twitter.com/",
    "http://google.com": "https://www.google.com/",
    "http://example.com": "error"
}
```

## requestInformations
An object literal associating requests URLs to their headers. The entries in this object follow the schema 
```json
{
    "top_frame1": {
        "requestType1": {
            "requestURL1": {
                "headername1": "headervalue1",
                "headername2": "..."
            },
            "requestURL2": { ... }
        }, 
        "requestType2": { ... }
    },
    "top_frame2": { ... }
}
```
where:
- `top_frame`: is the parent frame initiating a request. For top navigations tabs, this value is `about:blank`, or `null`, etc. For iframes and subresources (i.e. scripts, images), the `top_frame` is the URL of the page initiating embedding the iframe or loading the subresource
- `requestType`: is the type of the request, i.e. `document`, `image`, `script`. Slight differences may be observed depending on the automation tool used: [Puppeteer/Playwright](https://playwright.dev/docs/api/class-request#request-resource-type), or a [browser extension](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/ResourceType).
- `requestURL`, `headername` and `headervalue` are self-explanatory
  
Dumping the headers of all requests can take a lot of space. To avoid that, by default we only log requests of type `document`. The[requestypes](CONFIG.md#requestypes) configuration option can be adjusted to the types of requests to be logged.

## responseInformations
This object contains response headers. The structure is similar to [requestsInformation](#requestinformations). 

## swsRegs
An object holding information about service workers registrations. It structure is as follows:
```javaScript
{
    "urls": {
        "serviceworkerURL1": "",
        "serviceworkerURL2": "",
        "..."
    },
    "aurls": {
        "serviceworkerURL1": {
            "pageURL1": "",
            "pageURL2": "",
            "...": "",
        }
    },
    "errors": {
        "errormessage1": "",
        "errormessage2": "",
    },
    "updates": [], 
    "versions": [], 
    "swr": {
         "errormessage1": "",
        "errormessage2": "",
        "..."
    },
    "prb": {
        "errormessage1": "",
        "errormessage2": "",
        "..."
    },
    
    "coverage": {}
}
```
- `urls`  holds the list of registered service workers URLs. 
- `aurls` further associates a service worker URL to the URLs of pages where it [registration is initiated](https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer/register).
- `errors`: collects errors reported by when the [ServiceWorker domain](https://chromedevtools.github.io/devtools-protocol/tot/ServiceWorker/) of Chrome Devtools Protocol (CDP) is enabled with [Puppeteer](https://pptr.dev) or [Playwright](https://playwright.dev)  as automation tools. The `errors` can be a very important source of information for developers tracking errors in their service workers.
- `updates` and `versions` are additional information provided by the ServiceWorker domain about service workers updates and versions. We have removed this information from the logs. We may consider adding them via a configuration option
- `swr` and `prb` are similar to `errors` but holds logs generated by the [swebRequest](https://github.com/sqwr/swebrequest) [setup](CONFIG.md#setup)
- `coverage` was an unsuccessfull attempt to collect service workers coverage information with [Istanbul](https://istanbul.js.org/): may be added in the future


## swsData
This object contains the monitored service workers events and APIs calls. It general structure is as follows:
```javaScript
{
    "serviceworkerURL1": {
        "datasize1": {
            "loc": { 
                "origin": "serivceworkerOrigin", 
                "href": "serviceworkerURL", 
                "scope": "serviceworkerScope", 
                "scriptURL": "serviceworkerURL" 
            },
            "clients": { 
                "pageURL1": "", 
                "..." 
            },
            "data": [ datum1, datum2, ...]
        },
        "datasize2": { ... },
        "..."
    },
    "serviceworkerURL2": { ... },
    "..."
}
```